CREATE TABLE IF NOT EXISTS libros (
    id INT PRIMARY KEY AUTO_INCREMENT,
    titulo VARCHAR(200) NOT NULL,
    autor VARCHAR(200) NOT NULL,
    anio INT NOT NULL,
    genero VARCHAR(100) NOT NULL,
    editorial VARCHAR(100),
    paginas INT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
INSERT INTO libros (titulo, autor, anio, genero, editorial, paginas) VALUES 
('Cien años de soledad', 'Gabriel García Márquez', 1967, 'Realismo mágico', 'Editorial Sudamericana', 471),
('1984', 'George Orwell', 1949, 'Distopía', 'Secker & Warburg', 328),
('El Principito', 'Antoine de Saint-Exupéry', 1943, 'Fábula', 'Reynal & Hitchcock', 96),
('Don Quijote de la Mancha', 'Miguel de Cervantes', 1605, 'Novela', 'Francisco de Robles', 863),
('Crónica de una muerte anunciada', 'Gabriel García Márquez', 1981, 'Novela', 'Editorial Oveja Negra', 120),
('El amor en los tiempos del cólera', 'Gabriel García Márquez', 1985, 'Romance', 'Editorial Oveja Negra', 368),
('Rayuela', 'Julio Cortázar', 1963, 'Novela experimental', 'Editorial Sudamericana', 600),
('La sombra del viento', 'Carlos Ruiz Zafón', 2001, 'Misterio', 'Editorial Planeta', 576);
CREATE TABLE IF NOT EXISTS reservas (
    id INT PRIMARY KEY AUTO_INCREMENT,
    usuario VARCHAR(100) NOT NULL,
    titulo VARCHAR(200) NOT NULL,
    tipo VARCHAR(20) NOT NULL COMMENT 'pelicula o libro',
    fecha_reserva DATETIME NOT NULL,
    fecha_devolucion DATETIME NULL COMMENT 'NULL significa que está actualmente reservado',
    FOREIGN KEY (usuario) REFERENCES Usuarios(usuario) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
CREATE INDEX idx_reservas_usuario ON reservas(usuario);
CREATE INDEX idx_reservas_titulo ON reservas(titulo);
CREATE INDEX idx_reservas_activas ON reservas(fecha_devolucion);
CREATE INDEX idx_libros_titulo ON libros(titulo);
CREATE INDEX idx_libros_autor ON libros(autor);